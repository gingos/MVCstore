
@{
    Layout = null;
}

<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>showStock</title>
    <style>
        table.scroll {
            width: 85%;  
            /* Optional */
            /* border-collapse: collapse; */
            border-spacing: 5px;
            border: 2px solid black;
        }

            table.scroll tbody,
            table.scroll thead {
                display: block;
            }

        thead tr th {
            height: 30px;
            line-height: 30px;
            text-align: center; 
        }

        table.scroll tbody {
            height: 100px;
            overflow-y: auto;
            overflow-x: hidden;
        }

        tbody {
            border-top: 2px solid black;
        }

            tbody td,
            thead th {
                width: 10%; 
                /* Optional */
                border-right: 1px solid black;
                /* white-space: nowrap; */
            }

                tbody td:last-child,
                thead th:last-child {
                    border-right: none;
                }
    </style>
</head>
<body>
    <script src="~/Scripts/jquery-1.10.2.js"></script>
    <script src="~/Scripts/jquery.validate.js"></script>
    <script src="~/Scripts/jquery.validate.unobtrusive.js"></script>

    <div>
        <span style="color:blue">Better restock, winter is coming:</span><br />
        <div>
            <input id="allStock_bt" type="button" value="Show All Products" onclick="getJSON('getProductsByJSON', getAll)" />
            <input id="zeroStock_bt" type="button" value="Show 0-Quantity Products" onclick="getJSON('getZeroQuantityByJSON', getZero)" />
        </div>
        <div id="status"></div>
        <div>
            <table class="scroll" id="stockTable"></table>
        </div>
        <br />
    </div>

    <script language="javascript">
        // Change the selector if needed
        var $table = $('table.scroll'),
          $bodyCells = $table.find('tbody tr:first').children(),
          colWidth;

        // Adjust the width of thead cells when window resizes
        $(window).resize(function () {
            // Get the tbody columns width array
            colWidth = $bodyCells.map(function () {
                return $(this).width();
            }).get();

            // Set the width of thead columns
            $table.find('thead tr').children().each(function (i, v) {
                $(v).width(colWidth[i]);
            });
        }).resize(); // Trigger resize handler

    </script>

    <script language="javascript">
        debugger;
        function getJSON(action, getStock) {
            $("#status").text("Loading Table...");
            $.get(action, null, getStock);
        }
        //TODO: 
        // 2. fit big table into smaller frame
        // 3. write "begin purchase function" tree
        // 4. apply above to "0-stock" table


        // Code products table in html : (JSON list) prodList retrieved from action "getProductsByJSON"
        function getAll(stock) {
            $("#stockTable").find("tr").remove();
            var tbl = $("#stockTable");
            var header =
                "<thead>" +
                    "<tr>" +
                        "<th>Model</th>" +
                        "<th>Maker</th>" +
                        "<th>In Stock</th>" +
                        "<th>Type</th>" +
                        "<th>Order More?</th>" +
                        "<th></th>" +
                        "<th></th>" +
                    "</tr>" +
                 "</thead>";
            tbl.append(header);
            tbl.append("<tbody>")
            for (k = 0; k < stock.length; k++) {
                var row =
                    
                    "<tr id= 'all_row_" + k + "'>" +
                    "<td>" + stock[k].Model + "</td>" +
                    "<td>" + stock[k].Maker + "</td>" +
                    "<td>" + stock[k].Quantity + "</td>" +
                    "<td>" + stock[k].Type + "</td>" +
                    "<td><input type='text' id='all_count_" + k + "' value='0'/></div></td>" +
                    "<td><input type='button' id='all_bt_" + k + "' value='Add to Cart' onclick=\"purchaseProcess($(\'#all_count_" + k + "\').val()," + stock[k].Model + "," + stock[k].Price + "," + "\'stock_txt_" + k + "\')\"></td>" +
                    //"<td><input type='button' id='pc_bt_" + k + "' value='Add to Cart' onclick=\"addToCart(\'pc_row_" + k + "\')\"></td>" +                                              `
                    "<td id='stock_txt_" + k + "'>Stock Text</td>" +
                    "</tr>"
                tbl.append(row);
            }
            tbl.append("</tbody>")
            $("#status").text("")

        }

    </script>
</body>
</html>
