
@{
    Layout = null;
}

<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>showProducts</title>
</head>

<body>
    <script src="~/Scripts/jquery-1.10.2.js"></script>
    <script src="~/Scripts/jquery.validate.js"></script>
    <script src="~/Scripts/jquery.validate.unobtrusive.js"></script>
    <script src="~/Scripts/bootstrap.js"></script>
    <div> 
        <span style="color:blue" >Look at all these PRODUCTS:</span><br />
    </div>
    <div>
        <input id="getPC_bt" type="button" value="get PC" onclick="getJSON('getPCbyJSON', getPC)" />
        <input id="getPrinter_bt" type="button" value="get Printer" onclick="getJSON('getPrinterByJSON', getPrinter)" />
        <input id="getLaptop_bt" type="button" value="get Laptop" onclick="getJSON('getLaptopByJSON', getLaptop)" />
    </div>
    <div id="status"></div>
    <div>
        <table id="productsTable"></table>
    </div>
    <div class="col-md-4">
        <p><a class="btn btn-default" href="@Url.Action("showCart", "Products")">See Shopping Cart & Checkout &raquo;</a></p>
    </div>

    <script lang="javascript">
        

        function getJSON(action, getProduct) {
            $("#status").text("Loading Table...");
            $.get(action, null, getProduct);
        }

        function getPC(pcList) {
            $("#productsTable").find("tr").remove();
            var tbl = $("#productsTable");
            var header = "<tr>" +
                "<td>Model</td>" +
                "<td>Speed</td>" +
                "<td>RAM</td>" +
                "<td>HD</td>" +
                "<td>Price</td>" +
                "<td>Add?</td>" +
                "</tr>";
            tbl.append(header);
            for (k = 0; k < pcList.length; k++) {
                var row = "<tr>" +
                    "<td>" + pcList[k].Model + "</td>" +
                    "<td>" + pcList[k].Speed + "</td>" +
                    "<td>" + pcList[k].RAM + "</td>" +
                    "<td>" + pcList[k].HD + "</td>" +
                    "<td>" + pcList[k].Price + "</td>" +
                    "<td><input type='text' id='pc_count_" + k + "' value='0'/></div></td>" +
                    "<td><input type='button' id='pc_bt_" + k + "' value='Add to Cart' onclick='addToCart($(\"#pc_count_" + k + "\").val()," + pcList[k].Model + "," + pcList[k].Price + ")'></td>" +
                    "</tr>"
                tbl.append(row);
            }
            
            $("#status").text("")

        }
        function getPrinter(printerList) {
            $("#productsTable").find("tr").remove();
            var tbl = $("#productsTable");
            var header = "<tr>" +
                "<td>Model</td>" +
                "<td>Color</td>" +
                "<td>Type</td>" +
                "<td>Price</td>" +
                "<td>Add?</td>" +
                "</tr>";
            tbl.append(header);
            for (k = 0; k < printerList.length; k++) {
                var row = "<tr>" +
                    "<td>" + printerList[k].Model + "</td>" +
                    "<td>" + printerList[k].Color + "</td>" +
                    "<td>" + printerList[k].Type + "</td>" +
                    "<td>" + printerList[k].Price + "</td>" +
                    "<td><input type='text' id='pri_count_" + k + "' value='0'/></div></td>" +
                    "<td><input type='button' id='pri_bt_" + k + "' value='Add to Cart' onclick='addToCart($(\"#pri_count_" + k + "\").val()," + printerList[k].Model + "," + printerList[k].Price + ")'></td>" +
                    "</tr>"
                tbl.append(row);
            }

            $("#status").text("")

        }
        function getLaptop(laptopList) {
            $("#productsTable").find("tr").remove();
            var tbl = $("#productsTable");
            var header = "<tr>" +
                "<td>Model</td>" +
                "<td>Speed</td>" +
                "<td>RAM</td>" +
                "<td>HD</td>" +
                "<td>Screen</td>" +
                "<td>Price</td>" +
                "<td>Add?</td>" +
                "</tr>";
            tbl.append(header);
            for (k = 0; k < laptopList.length; k++) {
                var row = "<tr>" +
                    "<td>" + laptopList[k].Model + "</td>" +
                    "<td>" + laptopList[k].Speed + "</td>" +
                    "<td>" + laptopList[k].RAM + "</td>" +
                    "<td>" + laptopList[k].HD + "</td>" +
                    "<td>" + laptopList[k].Screen + "</td>" +
                    "<td>" + laptopList[k].Price + "</td> "+
                    "<td><input type='text' id='lap_count_" +k +"' value='0'/></div></td>" +
                    "<td><input type='button' id='lap_bt_" + k + "' value='Add to Cart' onclick='addToCart($(\"#lap_count_" + k +"\").val()," + laptopList[k].Model + "," + laptopList[k].Price + ")'></td>" +
                    "</tr>";

                tbl.append(row);
            }

            $("#status").text("")

        }

        function addToCart(quantity, model, price) {
            if (quantity == 0) {
                alert('please specify quantity');
                return;
            }
            //TODO: add confirmation box
            //consider using button->"this" for addToCart
            alert('buy: ' + quantity + ' of model # ' + model + ' for ' + price + '$');
            var url = '@Url.Action("addToCart", "Products")';
            var data = { quantity: quantity, model: model, price: price };
            $.post(url, data, null);
        }
    </script>
</body>
</html>
